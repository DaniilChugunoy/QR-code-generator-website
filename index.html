<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Генератор</title>
    <!-- импортирую библиотеку для создания иконок -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* основные стили для дальнейшего использования */
        :root {
            --primary: #667eea;
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --bg-glass: rgba(255, 255, 255, 0.95);
        }

        body {
            margin: 0;
            padding: 20px;
            font-family: 'Segoe UI', sans-serif;
            background: var(--gradient);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* основной контейнер с элементами страницы */
        .card {
            background: var(--bg-glass);
            width: 100%;
            max-width: 450px;
            padding: 30px;
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            text-align: center;
        }

        h1 {
            margin: 0 0 10px;
            background: var(--gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-size: 1.8rem;
        }
        
        .controls { text-align: left; margin-top: 20px; }
        label { font-weight: 600; font-size: 0.9rem; color: #555; display: block; margin-bottom: 8px; }

        /* текст, размер, цвет */
        textarea, select, input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5f1;
            border-radius: 12px;
            font-size: 14px;
            box-sizing: border-box;
            outline: none;
            background: #f8f9ff;
        }

        /* стиль для текста */
        textarea:focus, select:focus { border-color: var(--primary); background: #fff; }
        textarea { resize: vertical; min-height: 80px; }

        .row { display: flex; gap: 15px; margin-top: 15px; }
        .col { flex: 1; }/* задаю один размер для цвета и размера */
        input[type="color"] { padding: 5px; height: 45px; cursor: pointer; }/* стили для цвета */
        
        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
            color: white;
            margin-top: 20px;
            transition: transform 0.2s;
        }
        .btn:active { transform: scale(0.98); }
        .btn-gen { background: var(--gradient); }
        .btn-down { 
            background: linear-gradient(135deg, #4255a8 0%, #41047f 100%); 
            display: none;  
        }
        .btn-down:hover { 
            transform: translateY(-3px);
        }

        /* контейнер с кодом */
        #qr-container {
            margin-top: 25px;
            padding: 30px;
            background: #ffffff;
            border-radius: 16px;
            display: none;
            border: 2px dashed #2222225f;
        }

        /* настройка кода */
        #qrcode img, #qrcode canvas {
            margin: 0 auto;
            display: block;
            max-width: 100%;
            height: auto;
        }

        /* стили для кнопки поделиться и модального окна */
        .share-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 100;
            transition: all 0.3s;
        }
        /* движение кнопки */
        .share-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 16px rgba(0,0,0,0.3);
        }

        /* окно поделиться */
        .share-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none; /* скрыт по умолчанию */
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .share-content {
            background: rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 20px;
            width: 90%;
            max-width: 300px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            text-align: center;
        }
        .social-icons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }
        .icon-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
        }
        .whatsapp { background: #25D366; }
        .telegram { background: #0088cc; }
        .viber { background: #7360F2; }
        .discord { background: #5865F2; }
    </style>
</head>
<body>

    <!-- Кнопка поделиться -->
    <button class="share-btn" onclick="openShareModal()" title="Поделиться">
        <i class="fas fa-share-alt"></i>
    </button>

    <!-- Модальное окно для выбора соцсетей -->
    <div id="shareModal" class="share-modal">
        <div class="share-content">
            <h3 style="margin:0 0 15px 0;">Поделиться</h3>
            <div class="social-icons">
                <button class="icon-btn whatsapp" onclick="shareTo('whatsapp')" title="WhatsApp"><i class="fab fa-whatsapp"></i></button>
                <button class="icon-btn telegram" onclick="shareTo('telegram')" title="Telegram"><i class="fab fa-telegram"></i></button>
                <button class="icon-btn viber" onclick="shareTo('viber')" title="Viber"><i class="fab fa-viber"></i></button>
                <button class="icon-btn discord" onclick="shareTo('discord')" title="Discord"><i class="fab fa-discord"></i></button>
            </div>
            <button onclick="copyLink()" style="margin-top:10px; padding:12px; width:100%; background:#667eea; color:white; border:none; border-radius:10px; cursor:pointer;">
                <i class="fas fa-copy"></i> Копировать ссылку
            </button>
        </div>
    </div>

    <div class="card">
        <h1><i class="fas fa-qrcode"></i> QR Генератор</h1>
        <p style="color: #666; font-size: 0.9rem;">простой и удобный</p>

        <div class="controls">
            <div>
                <label>Текст или ссылка:</label>
                <textarea id="text" placeholder="https://example.com"></textarea> <!-- поле для ввода текста  --> 
            </div>

            <div class="row">
                <div class="col">
                    <label>Размер:</label> 
                    <select id="size"> <!-- элменет с выпадающим списком -->
                        <!-- пункты для списка -->
                  
                        <option value="200">200 px</option>
                        <option value="300" selected>300 px</option><!-- Делает пункт выбранным по умолчанию -->
                        <option value="400">400 px</option>
                        <option value="500">500 px</option>
                    </select>
                </div>
                <div class="col">
                    <label>Цвет:</label>
                    <input type="color" id="color" value="#000000"><!-- окно для изменения цвета -->
                </div>
            </div>
        </div>

        <!-- создаем кнопку с иконкой -->
        <button class="btn btn-gen" onclick="makeQR()">
            <i class="fas fa-magic"></i> Создать QR-код</button>

            <!-- контейнер в котором появляется qr-код -->
        <div id="qr-container">
            <div id="qrcode"></div>
        </div>

        <!-- создаем кнопку с иконкой -->
        <button id="btn-dl" class="btn btn-down" onclick="downloadQRWithPadding()">
            <i class="fas fa-download"></i> Скачать
        </button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <script>
        const textInput = document.getElementById("text");
        const sizeSelect = document.getElementById("size");
        const colorInput = document.getElementById("color");
        const qrContainer = document.getElementById("qr-container");
        const qrcodeDiv = document.getElementById("qrcode");
        const downloadBtn = document.getElementById("btn-dl");
        const shareModal = document.getElementById("shareModal");
        let qrCodeObj = null;

        function makeQR() {
            const text = textInput.value.trim();
            if (!text) { alert("Введите текст!"); return; }

            qrcodeDiv.innerHTML = "";
            qrContainer.style.display = "block";

            setTimeout(() => {
                try {
                    qrCodeObj = new QRCode(qrcodeDiv, {
                        text: text,
                        width: parseInt(sizeSelect.value),
                        height: parseInt(sizeSelect.value),
                        colorDark : colorInput.value,
                        colorLight : "#ffffff",
                        correctLevel : QRCode.CorrectLevel.H
                    });
                    downloadBtn.style.display = "block";
                } catch (e) { console.error(e); }
            }, 50);
        }

        function downloadQRWithPadding() {
            const element = qrcodeDiv.querySelector("canvas") || qrcodeDiv.querySelector("img");
            if (!element) { alert("Ошибка: QR-код не найден"); return; }

            const padding = 40;
            const currentSize = parseInt(sizeSelect.value);
            const canvas = document.createElement("canvas");
            canvas.width = currentSize + (padding * 2);
            canvas.height = currentSize + (padding * 2);
            const ctx = canvas.getContext("2d");
            ctx.fillStyle = "#ffffff";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(element, padding, padding, currentSize, currentSize);

            const link = document.createElement("a");
            link.download = `qrcode.png`;
            link.href = canvas.toDataURL("image/png");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Функции для кнопки поделиться
        function openShareModal() { shareModal.style.display = 'flex'; }
        function closeShareModal() { shareModal.style.display = 'none'; }
        function shareTo(app) {
            const url = window.location.href;
            const text = "Посмотрите этот QR-генератор: ";
            if(app === 'whatsapp') window.open(`https://wa.me/?text=${encodeURIComponent(text + url)}`, '_blank');
            else if(app === 'telegram') window.open(`https://t.me/share/url?url=${encodeURIComponent(url)}&text=${encodeURIComponent(text)}`, '_blank');
            else if(app === 'viber') window.open(`viber://forward?text=${encodeURIComponent(text + url)}`, '_blank');
            else if(app === 'discord') window.open(`https://discord.com/channels/@me?content=${encodeURIComponent(text + url)}`, '_blank');
            closeShareModal();
        }
        function copyLink() {
            navigator.clipboard.writeText(window.location.href)
                .then(() => { alert("Ссылка скопирована!"); closeShareModal(); })
                .catch(() => { 
                    const input = document.createElement('input');
                    input.value = window.location.href;
                    document.body.appendChild(input);
                    input.select();
                    document.execCommand('copy');
                    document.body.removeChild(input);
                    alert("Ссылка скопирована!");
                    closeShareModal();
                });
        }
        window.onclick = function(event) { if (event.target === shareModal) closeShareModal(); }

        window.onload = makeQR;
    </script>
</body>
</html>